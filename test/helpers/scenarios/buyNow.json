{
  "title": "Pool: BuyNow",
  "description": "Test cases for the buyNow function.",
  "stories": [
    {
      "description": "User deposit 120 eth to junior, buy nft and revert",
      "actions": [
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "0",
            "amount": "120000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "buyNow",
          "args": {
            "cname": "TUS",
            "tokenId": "1",
            "nftprice": "10000000000000000000",
            "purchasingData": "0x0000000000000000000000004a679253410272dd5232b3ff7cf5dbb88f295319b4e4b29600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266000000000000000000000000a85233c63b9ee964add6f2cffe00fd84eb32338f00000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000002279b7a0a67db372996a5fab50d91eaa73d2ebe600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000166fdd5e25ef9ddb305ba3c2aae1856ab9c6f297900000000000000000000000066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000056dc70a01f79c68e3ac7b0a5700b500406702c070000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000002066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000",
            "user": "0"
          },
          "expected": "InsufficientLiquidity"
        }
      ]
    },
    {
      "description": "User deposit 120 eth to junior, buy with a invalid vault",
      "actions": [
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "0",
            "amount": "120000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "buyNow",
          "args": {
            "cname": "TUS",
            "tokenId": "1",
            "nftprice": "1000000000000000000",
            "purchasingData": "0x0000000000000000000000004a679253410272dd5232b3ff7cf5dbb88f295319b4e4b29600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266000000000000000000000000a85233c63b9ee964add6f2cffe00fd84eb32338f00000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000002279b7a0a67db372996a5fab50d91eaa73d2ebe600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000166fdd5e25ef9ddb305ba3c2aae1856ab9c6f297900000000000000000000000066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000056dc70a01f79c68e3ac7b0a5700b500406702c070000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000002066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000",
            "user": "1"
          },
          "expected": "Unauthorised"
        }
      ]
    },
    {
      "description": "User deposit 120 eth to junior, buy a invalid nft and revert",
      "actions": [
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "0",
            "amount": "120000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "buyNow",
          "args": {
            "cname": "TUS",
            "tokenId": "1",
            "nftprice": "0",
            "purchasingData": "0x0000000000000000000000004a679253410272dd5232b3ff7cf5dbb88f295319b4e4b29600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266000000000000000000000000a85233c63b9ee964add6f2cffe00fd84eb32338f00000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000002279b7a0a67db372996a5fab50d91eaa73d2ebe600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000166fdd5e25ef9ddb305ba3c2aae1856ab9c6f297900000000000000000000000066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000056dc70a01f79c68e3ac7b0a5700b500406702c070000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000002066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000",
            "user": "0"
          },
          "expected": "InvalidFloorPrice"
        }
      ]
    },
    {
      "description": "User deposit 120 eth to junior, buy a nft with invalid principal",
      "actions": [
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "0",
            "amount": "120000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "buyNow",
          "args": {
            "cname": "TUS",
            "tokenId": "1",
            "nftprice": "1000000000000000000",
            "purchasingData": "0x0000000000000000000000004a679253410272dd5232b3ff7cf5dbb88f295319b4e4b29600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266000000000000000000000000a85233c63b9ee964add6f2cffe00fd84eb32338f00000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000002279b7a0a67db372996a5fab50d91eaa73d2ebe600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000166fdd5e25ef9ddb305ba3c2aae1856ab9c6f297900000000000000000000000066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000056dc70a01f79c68e3ac7b0a5700b500406702c070000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000002066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000",
            "user": "0"
          },
          "expected": "InvalidPrincipal"
        }
      ]
    },
    {
      "description": "User deposit 50 eth to junior, 120 eth to senior, then buy nft",
      "actions": [
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "1",
            "amount": "50000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "deposit",
          "args": {
            "cname": "TUS",
            "tranche": "0",
            "amount": "120000000000000000000",
            "user": "0"
          },
          "expected": "success"
        },
        {
          "name": "buyNow",
          "args": {
            "cname": "TUS",
            "tokenId": "1",
            "nftprice": "10000000000000000000",
            "purchasingData": "0x0000000000000000000000004a679253410272dd5232b3ff7cf5dbb88f295319b4e4b29600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000002400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266000000000000000000000000a85233c63b9ee964add6f2cffe00fd84eb32338f00000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000002279b7a0a67db372996a5fab50d91eaa73d2ebe600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000166fdd5e25ef9ddb305ba3c2aae1856ab9c6f297900000000000000000000000066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000000000000000000000000000000000000000000000000000000000000000000212340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000056dc70a01f79c68e3ac7b0a5700b500406702c070000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000002066fdd5e25ef9ddb305ba3c2aae1856ab9c6f2979000000000000000000000000",
            "user": "0"
          },
          "expected": "success"
        }
      ]
    }
  ]
}